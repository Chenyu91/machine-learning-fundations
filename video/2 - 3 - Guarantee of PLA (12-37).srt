1
00:00:00,000 --> 00:00:05,340
好，那我們來看看說PLA什麼時候可能會停下來

2
00:00:05,340 --> 00:00:11,460
在想這個問題之前我們先回頭想PLA的宗旨條件是什麼，是它如果找到一條線

3
00:00:11,460 --> 00:00:20,150
把這個資料都分的完全沒有犯任何錯誤那麼PLA就停下來了
要達成這個宗旨條件至少至少要有一件事情

4
00:00:20,150 --> 00:00:28,590
你的資料要能夠有一條線可以切開，如果你的
資料根本就沒有一條線可以切開，PLA跑一輩它也不會停下來的

5
00:00:28,590 --> 00:00:35,560
那這樣的條件，我們就把它叫做Linear Separable線性可分，好例如說

6
00:00:35,560 --> 00:00:42,530
我們左邊這個資料，大家可以看到，欸我可以找這條線，就可以把圈圈跟叉叉分在對的地方，-
這叫做線性可分

7
00:00:42,530 --> 00:00:47,970
那什麼樣的資料不是線性可分的，例如說欸，如果今天是這樣的資料

8
00:00:47,970 --> 00:00:54,285
大家可以想你不管怎麼轉，你的線總會有一些圈圈在錯誤的地方，或有一些叉叉在

9
00:00:54,285 --> 00:01:00,600
這個錯誤的地方，我們永遠沒有辦法用一條線就把東西這個一刀兩段通通都分對了

10
00:01:00,600 --> 00:01:05,390
然後或者這樣的資料也不是線性可分，我們可能可以用圓圈圈把它分開

11
00:01:05,390 --> 00:01:11,380
不過如果你堅持要用一條線的話，怎麼切你一定不可能把圈圈切在一邊，叉叉切在一邊

12
00:01:11,380 --> 00:01:20,190
好，右邊這兩種情形都不是線性可分的情形
那左邊這個情形線性可分，當然大家可以想像這是一個比較簡單的情形

13
00:01:20,190 --> 00:01:28,190
眼尖的同學可能會發現，右邊這兩種情形實際上就是我們課程的Logo裡面我用的那兩個圖案

14
00:01:28,190 --> 00:01:36,260
大家會發現到我們在未來課程裡會慢慢介紹更多的方法
來處理這兩種情形實際上我們等一下就會介紹方法來處理這個

15
00:01:36,260 --> 00:01:40,570
一部分的這個情形好

16
00:01:40,570 --> 00:01:50,414
所以我們現在來秀給大家看說，PLA的保證是什麼的時候，我們就說我們先假設最簡單的
情形，我們有一條線，好，Linear

17
00:01:50,414 --> 00:01:56,315
Seperable 有一條線的時候，那麼PLA到底會不會

18
00:01:56,315 --> 00:02:05,420
停下來呢，到底會不會找到一條這樣的線呢 好我們來看看，有一條線代表什麼意思

19
00:02:05,420 --> 00:02:14,496
我們把這條線就叫做WF好了，F這是故意用的，就想像這條線就是我們的目標好了
就是我們那個大家記得的話，F是我們的所謂的Target

20
00:02:14,496 --> 00:02:21,890
Function，我們的目標函數
就想像它那個線是我們的目標，那這條目標有什麼特性，這個目標這條線的

21
00:02:21,890 --> 00:02:30,670
YN一定跟WF乘上XN 好，這個取這個正負號一定是一樣的，這條線很完美

22
00:02:30,670 --> 00:02:39,530
通通都切開了，所以呢這個正的就在正的那邊，負的
就在那個負的那邊，數學上這代表什麼意思，數學上這代表

23
00:02:39,530 --> 00:02:49,050
每一個點如果我用這條線把它這個用下去，所以
我用WF乘以XN來算說，它離這個線的這個距離有多遠

24
00:02:49,050 --> 00:02:54,120
ok當然是代正負號的距離乘上這個Y，乘上我們想要它在哪一邊的話

25
00:02:54,120 --> 00:03:00,670
這個每一個這個質都要大於0，也就是說它都要離線有一個距離

26
00:03:00,670 --> 00:03:10,530
都要大於零，因為這條線是這麼的完美，所以你接下去
圈圈就在圈圈那邊，叉叉就在叉叉那邊，它不會在線上，也不會在錯誤的那一邊

27
00:03:10,530 --> 00:03:16,510
那也就是說，記得我們PLA每次是選一個點嗎

28
00:03:16,510 --> 00:03:22,670
我們選到的那個錯誤的點，我們現在的這個W犯錯誤的點

29
00:03:22,670 --> 00:03:30,530
也會滿足這個性質，它的Y乘上WF，WF是我們想像的那條線乘上X

30
00:03:30,530 --> 00:03:35,010
好也會大於0，因為這個他會比所有這個裡面最

31
00:03:35,010 --> 00:03:44,020
小的那個都來的大，有了這樣的基礎，我們就可以去看什麼呢，我們去看一件事情 看說WF

32
00:03:44,020 --> 00:03:49,510
跟我們真正那個PLA在找的那個WT之間的關係是什麼

33
00:03:49,510 --> 00:03:59,490
我們可以看看說WF和WT到底接不接近
衡量兩個向量接不接近有好幾種方法，其中一方法就是把它們做內積

34
00:03:59,490 --> 00:04:05,360
內積的質越大，某種角度就代表越接近，好我們看到這個內積的質發生什麼事

35
00:04:05,360 --> 00:04:09,720
更新以後的內積質是WF乘上WT加1

36
00:04:09,720 --> 00:04:19,380
那這更新怎麼來的，大家記得PLA怎麼來的，他說我把原來的WT
加上我犯的錯誤叫我要怎麼轉

37
00:04:19,380 --> 00:04:26,850
好所以數學上我就列出來，這只是根據更新的事實，找出一個錯誤的點然後呢，恩這個做更新

38
00:04:26,850 --> 00:04:31,740
作更新以後，所以大家發現我們這個乘法有兩項

39
00:04:31,740 --> 00:04:37,530
第一項不太重要，啊反正就是原來的WF跟WT的關係

40
00:04:37,530 --> 00:04:42,125
ok第二項是有趣的，我們上面有個什麼式子

41
00:04:42,125 --> 00:04:50,805
我們上面有個式子說，欸這一個乘積還要乘上WF喔 就在這裡喔，會大於等於，所有人裡面

42
00:04:50,805 --> 00:04:57,940
呃所有人裡面有點像離那個線最近 的那個人，好所以我們就換過來，這是上面告訴我們

43
00:04:57,940 --> 00:05:06,410
的事情，上面告訴我們說，我們要 看這個乘積的話，它會大於等於離線最近的那個人

44
00:05:06,410 --> 00:05:13,690
然後呢，離線最近的那個人，我們剛才說離線最近的那個人，還是在正確的那邊，所以我們會-
有一個這個大於0的質

45
00:05:13,690 --> 00:05:21,560
好所以前面那項列出來有一個大於0的質 有一個大於0的質代表什麼

46
00:05:21,560 --> 00:05:27,860
我們如果就看WF跟WT的乘積還有WF跟WT加一的乘積的話

47
00:05:27,860 --> 00:05:37,460
這個比較小，這個比較大，加上了一個這個正 的東西，所以WF的WT的乘積好像就

48
00:05:37,460 --> 00:05:45,700
越來越大越來越大，代表什麼，兩個向量的內積越來越大代表什麼
某種角度代表兩個向量越來越接近

49
00:05:45,700 --> 00:05:51,140
看起來很好，所以我們經過PLA以後，兩個向量越來越接近

50
00:05:51,140 --> 00:06:00,965
數學比較好的同學可能就會，欸馬上就說，老師你這樣說不對
兩個向量的內積越來越大，可是你沒有考慮什麼，你沒有

51
00:06:00,965 --> 00:06:10,200
考慮向量的長度阿，所以內積越來越大，我把一個這個這個
一個如果兩個向量的內積是正的，把一個向量乘兩倍乘三倍乘四倍，內積也會越來越大

52
00:06:10,200 --> 00:06:16,080
ok所以不是它們真的接近，不是它們角度上真的接近，它們搞不好是因為長度上的問題

53
00:06:16,080 --> 00:06:24,030
好所以我們現在是這裡一半，我們只說 我們PLA的過程中找的那個向量

54
00:06:24,030 --> 00:06:32,440
看似跟WF我們夢想中的那個向量，越來越接近了
但是我們還要處理什麼，還要處理說向量長度的問題

55
00:06:32,440 --> 00:06:38,890
我們要使用到關鍵是這樣，大家看到說我們在上一頁裡面，我們只說我們拿X來更新而已

56
00:06:38,890 --> 00:06:43,490
實際上我們還沒有用到PLA最重要的一個性質說

57
00:06:43,490 --> 00:06:50,225
我們有錯才更新，有錯什麼意思，有錯就是說，如果我把WT

58
00:06:50,225 --> 00:06:56,960
乘上X的這個這個符號，跟Y做比較的話，這兩個符號是不一樣的，這才叫做有錯嘛

59
00:06:56,960 --> 00:07:03,370
那或者我們用一個更簡潔的表示的話，我們如果看WT乘上X

60
00:07:03,370 --> 00:07:09,590
這跟Y是異號的，異號的意思就是說，這些通通乘起來會小於等於0

61
00:07:09,590 --> 00:07:17,260
好我們現在來用到這個性質，那這個性質看什麼呢，好，我們看WT加1更新之後的

62
00:07:17,260 --> 00:07:23,310
長什麼樣子，我們知道現在已經知道WT＋1，就是WT跟那個更新的那個項目兩個部分

63
00:07:23,310 --> 00:07:28,990
我們如果看它的長度，或說它的長度的平方的話，會發現裡面有兩個項，第一個項

64
00:07:28,990 --> 00:07:34,670
就是WT，好，不管第二個項是這個跟X有關這個平方，我們先不管它

65
00:07:34,670 --> 00:07:41,210
我們來看中間那個項，ok所以兩個項平方以後，拆成三個項，中間那個項長什麼樣子

66
00:07:41,210 --> 00:07:46,890
有Y有W有X，在哪裡啊

67
00:07:46,890 --> 00:07:54,180
上面藍色的字的這邊，我會用一些顏色來帶領大家去找說欸，這在哪裡

68
00:07:54,180 --> 00:08:00,440
好，所以看到了我們剛才上面已經說了，用這個更新的話藍色這部分會怎麼樣

69
00:08:00,440 --> 00:08:09,250
會小於等於0，寫下來小於等於0 小於等於0代表什麼，所以如果我們只有犯錯

70
00:08:09,250 --> 00:08:17,580
才更新的話，我們的WT是不會成長太快的 因為它會加上一個負的項上去，它就不會成長太快

71
00:08:17,580 --> 00:08:26,720
它會成長只會靠哪個項成長，只會靠最後這個我們
後來標成紅色的這項成長，中間這項不會給他任何的成長

72
00:08:26,720 --> 00:08:33,490
好，那這個紅色這項最後會怎麼樣呢，紅色這項是我們隨便選的一個這個犯錯的點哪

73
00:08:33,490 --> 00:08:43,430
那我們可以把它跟所有資料裡面的點來作比較，也許是跟
什麼點呢，跟最遠的那個點X跟最長的那個點作比較

74
00:08:43,430 --> 00:08:50,060
好，那我們會有這樣的不等式，因為任何一個點會比最長的那個點的這個長度平方還來的小

75
00:08:50,060 --> 00:08:56,680
大家注意到我把這邊的YN標成灰色，為什麼，因為我們YN如果大家記得的話是什麼

76
00:08:56,680 --> 00:09:03,390
正1或負1平方以後沒有差，對長度的影響沒有差別，所以重要的是這個XN的平方

77
00:09:03,390 --> 00:09:11,880
所以我們跟這個XN的平方，最大的那個XN的平方來作比較
然後我們就發現說，WT每次最多長多少

78
00:09:11,880 --> 00:09:20,320
最多就長最長的XN平方那麼多 其它項都不是正的，只有這一項是正的，最多最多就長這麼多

79
00:09:20,320 --> 00:09:25,560
好，所以前一頁說WT跟WF越來越靠近

80
00:09:25,560 --> 00:09:30,800
每次都會靠近一定的份量，這一頁說WT慢慢地長

81
00:09:30,800 --> 00:09:38,430
如果我們把這兩頁結果合起來，那我這個留給大家做練習，可能要拿出一張紙來把這兩個結-
果寫下來

82
00:09:38,430 --> 00:09:47,005
你會發現，如果你從這個0開始一路做更新 做了T個更新之後，你看兩你看內積

83
00:09:47,005 --> 00:09:55,745
看哪兩個東西的內積，看兩個正規化的向量內積
我們把WF我們想像那個東西的正規化，我們把WT

84
00:09:55,745 --> 00:10:04,640
經過了T次更新後，我們得到那個向量也作正規化 這兩個正規化的向量的乘積會大於等於

85
00:10:04,640 --> 00:10:11,530
根號T根號的大T乘上某個常數，ok那當然大家花點力氣去把這個常數

86
00:10:11,530 --> 00:10:20,960
是什麼寫出來，這代表什麼兩個向量 兩個正規化向量的內積，真的就是代表它們角度有多靠近

87
00:10:20,960 --> 00:10:29,220
就是這個，我們大家如果說內積的話，就是所謂的cosine theta
就是這個角度如果叫做theta的話，它真的就代表越來越靠近

88
00:10:29,220 --> 00:10:37,010
每一輪每次經過一次這個更新，就靠近一點點，靠近的這個速度大概是這個，跟你更新的次數-
成一個根號比例

89
00:10:37,010 --> 00:10:43,270
那它們可不可能無限次的靠近，不可能，為什麼，因為兩個向量最大內積多少

90
00:10:43,270 --> 00:10:49,110
1，好，每次靠近一點，每次靠近一點，他會不會一路長上去

91
00:10:49,110 --> 00:10:54,950
然後到某一個地方，它不可能無限次的長，所以我們證明了這個演算法

92
00:10:54,950 --> 00:11:01,850
會停下來，好，我們這邊留給大家一個練習，確保說大家有聽得懂

93
00:11:01,850 --> 00:11:08,750
我們剛才在推導的是什麼樣的東西，而這個練習是這樣的，就是我們這個PLA呢到底要-
更新幾次

94
00:11:08,750 --> 00:11:14,030
才會停下來，這個數字實際上根據我們剛才推導是可以算出來的

95
00:11:14,030 --> 00:11:19,340
那我們這邊定義兩個東西，一個叫做R平方，這個R平方大家看到說有人

96
00:11:19,340 --> 00:11:24,650
把它叫做半徑的平方，就是說你每一個向量的長度，最大的那個是多少

97
00:11:24,650 --> 00:11:31,460
然後另外一個呢，這叫做ρ，這個ρ是什麼呢，是我們那個我們想要的那條線，我們目標

98
00:11:31,460 --> 00:11:38,270
的那條線的法向量，然後跟我的每個點的內積，然後根據它的YN是正1還是負1

99
00:11:38,270 --> 00:11:45,850
看看在哪個方向，然後那如果今天是線性可分的話，這個ρ一定是大於0的，一定是正的

100
00:11:45,850 --> 00:11:51,735
好，那今天我們就用這兩個質來算算看說，PLA到底最多更新幾次

101
00:11:51,735 --> 00:11:57,620
就會停，那請大家做個推導，然後看看你能夠寫出來，PLA更新

102
00:11:57,620 --> 00:12:05,620
幾次就會停下來，好，那我們希望大家呢，有寫到這個正確的答案就是

103
00:12:05,620 --> 00:12:12,410
我們之前講過內積的兩個這個正規化的向量的內積，最多最多是1喔，所以你如果跑到

104
00:12:12,410 --> 00:12:19,200
T次，那你這個PLA，這個剛才算的那個數字要成長根號t這麼多呢，它不可能無限大的

105
00:12:19,200 --> 00:12:27,200
跑下去，所以呢，那最後最後幾次會停下來，最多最多就是1，除上我們剛才說的那個

106
00:12:27,200 --> 00:12:32,500
常數，那個常數是可以用R跟ρ表現出來的平方，好，那這個數字

107
00:12:32,500 --> 00:12:37,800
就是最多最多更新的數字，那我們的參考答案是2

